## MySQL ###################################################################
filter {
  if [event][dataset] == "mysql" {
    if [mysql] {

      mutate {

        rename => {
          "[mysql][arg]" => "[mysql][args]"
          "[mysql][cmd]" => "[mysql][command]"
          "[mysql][success]" => "[mysql][successful]"
        }

        copy => { "[kerberos][request][client]" => "[client][user][name]" }

        merge => { "[related][id]" => "[log][id][fuid]" }
        merge => { "[related][id]" => "[log][id][client_cert_fuid]" }
        merge => { "[related][id]" => "[log][id][server_cert_fuid]" }

      }

      # Event outcome
      if [mysql][successful] {
        translate {
          field => "[mysql][successful]"
          exact => true
          dictionary => [
            "true", "success",
            "false", "failure"
          ]
          destination => "[event][outcome]"
        }
      }

    }
  }
}
